# DSP 服务配置

# 服务基本信息
SERVICE_NAME=dsp-server
SERVICE_VERSION=1.0.0
SERVICE_PORT=8080
SERVICE_REGION=cn-east-1
SERVICE_ZONE=zone-1

# 服务发现配置
CONSUL_HOST=consul.service.internal
CONSUL_PORT=8500
CONSUL_DC=dc1
CONSUL_TOKEN=${CONSUL_TOKEN}

# 数据库配置
DB_HOST=postgres-master.service.internal
DB_PORT=5432
DB_USER=${DB_USER}
DB_PASSWORD=${DB_PASSWORD}
DB_NAME=simple_dsp
DB_SSL_MODE=verify-full
DB_MAX_OPEN_CONNS=100
DB_MAX_IDLE_CONNS=20
DB_CONN_MAX_LIFETIME=1h

# Redis 配置
REDIS_MASTER=redis-master.service.internal:6379
REDIS_SLAVES=redis-slave-1.service.internal:6379,redis-slave-2.service.internal:6379
REDIS_PASSWORD=${REDIS_PASSWORD}
REDIS_DB=0
REDIS_POOL_SIZE=100
REDIS_MIN_IDLE_CONNS=10

# Kafka 配置
KAFKA_BROKERS=kafka-1.service.internal:9092,kafka-2.service.internal:9092,kafka-3.service.internal:9092
KAFKA_TOPIC_PREFIX=dsp
KAFKA_GROUP_ID=dsp-server-group
KAFKA_VERSION=2.8.0

# RTA 服务配置
RTA_BASE_URL=https://rta.service.internal
RTA_APP_KEY=${RTA_APP_KEY}
RTA_APP_SECRET=${RTA_APP_SECRET}
RTA_TIMEOUT=100ms
RTA_RETRY_TIMES=3
RTA_RETRY_DELAY=50ms

# 监控配置
PROMETHEUS_ENABLED=true
PROMETHEUS_PORT=9090
PROMETHEUS_PATH=/metrics
GRAFANA_ENABLED=true
GRAFANA_PORT=3000

# 日志配置
LOG_LEVEL=info
LOG_FORMAT=json
LOG_OUTPUT=stdout
LOG_FILE_PATH=/var/log/dsp-server
LOG_MAX_SIZE=100
LOG_MAX_BACKUPS=10
LOG_MAX_AGE=30
LOG_COMPRESS=true

# 安全配置
TLS_ENABLED=true
TLS_CERT_FILE=/etc/dsp-server/ssl/server.crt
TLS_KEY_FILE=/etc/dsp-server/ssl/server.key
TLS_CA_FILE=/etc/dsp-server/ssl/ca.crt

# 限流配置
RATE_LIMIT_ENABLED=true
RATE_LIMIT_QPS=1000
RATE_LIMIT_BURST=2000

# 缓存配置
CACHE_ENABLED=true
CACHE_TYPE=redis
CACHE_TTL=1h
CACHE_CLEANUP_INTERVAL=10m

# 追踪配置
TRACING_ENABLED=true
TRACING_TYPE=jaeger
TRACING_ENDPOINT=http://jaeger.service.internal:14268/api/traces
TRACING_SAMPLE_RATE=0.1

# 告警配置
ALERT_ENABLED=true
ALERT_TYPE=prometheus
ALERT_ENDPOINT=http://alertmanager.service.internal:9093
ALERT_CHECK_INTERVAL=30s

# 资源限制
CPU_LIMIT=4
MEMORY_LIMIT=8G
DISK_LIMIT=20G

# 健康检查
HEALTH_CHECK_ENABLED=true
HEALTH_CHECK_INTERVAL=30s
HEALTH_CHECK_TIMEOUT=5s
HEALTH_CHECK_RETRIES=3

# 优雅关闭
GRACEFUL_SHUTDOWN_TIMEOUT=30s
GRACEFUL_SHUTDOWN_WAIT=5s 